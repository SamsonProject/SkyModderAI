{% extends "business/layout.html" %}

{% block title %}{{ category_info.label if category_info else category }} | Education Hub{% endblock %}

{% block content %}
<div class="hub-category-page" style="max-width: 1200px; margin: 0 auto; padding: 2rem 1rem;">
    <!-- Breadcrumb -->
    <nav class="breadcrumb" style="margin-bottom: 2rem; font-size: 0.9rem;">
        <a href="{{ url_for('business.hub_landing') }}" style="color: var(--primary-color); text-decoration: none;">
            ‚Üê Education Hub
        </a>
    </nav>

    <!-- Category Header -->
    <div class="category-header" style="margin-bottom: 3rem; text-align: center;">
        {% if category_info %}
            <div style="font-size: 3rem; margin-bottom: 1rem;">{{ category_info.icon }}</div>
            <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">{{ category_info.label }}</h1>
            <p style="color: var(--text-muted); font-size: 1.1rem; max-width: 600px; margin: 0 auto;">
                {{ category_info.description }}
            </p>
        {% else %}
            <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">{{ category | replace('_', ' ') | title }}</h1>
        {% endif %}
    </div>

    <!-- Resources Grid -->
    {% if resources %}
        <div class="resources-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
            {% for resource in resources %}
                <div class="resource-card" style="
                    padding: 1.5rem;
                    border-radius: 8px;
                    background: var(--bg-color-light);
                    border: 1px solid var(--border-color);
                    transition: transform 0.2s, box-shadow 0.2s;
                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';"
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                    
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <span class="resource-type" style="
                            padding: 0.25rem 0.75rem;
                            border-radius: 20px;
                            font-size: 0.75rem;
                            font-weight: 600;
                            text-transform: uppercase;
                            background: {% if resource.resource_type == 'video' %}#ffe4e6{% elif resource.resource_type == 'tool' %}#dbeafe{% else %}#f0fdf4{% endif %};
                            color: {% if resource.resource_type == 'video' %}#e11d48{% elif resource.resource_type == 'tool' %}#2563eb{% else %}#16a34a{% endif %};
                        ">
                            {{ resource.resource_type }}
                        </span>
                        {% if resource.contributed_by_business_id %}
                            <span style="font-size: 0.75rem; color: var(--text-muted);">
                                üè¢ Business Contribution
                            </span>
                        {% endif %}
                    </div>

                    <h3 style="font-size: 1.25rem; margin-bottom: 0.5rem;">{{ resource.title }}</h3>
                    
                    <p style="color: var(--text-muted); font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.6;">
                        {{ resource.description[:150] }}{% if resource.description|length > 150 %}...{% endif %}
                    </p>

                    {% if resource.content %}
                        <div style="margin-bottom: 1rem; padding: 1rem; background: white; border-radius: 4px; font-size: 0.9rem;">
                            {{ resource.content[:200] }}{% if resource.content|length > 200 %}...{% endif %}
                        </div>
                    {% endif %}

                    <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                        <span style="font-size: 0.85rem; color: var(--text-muted);">
                            {% if resource.author %}By {{ resource.author }}{% else %}Community{% endif %}
                        </span>
                        {% if resource.upvotes and resource.upvotes > 0 %}
                            <span style="font-size: 0.85rem; color: var(--primary-color);">
                                üëç {{ resource.upvotes }} upvotes
                            </span>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-resources" style="text-align: center; padding: 4rem 2rem; background: var(--bg-color-light); border-radius: 8px;">
            <div style="font-size: 3rem; margin-bottom: 1rem;">üìö</div>
            <h3 style="font-size: 1.25rem; margin-bottom: 0.5rem;">No resources yet</h3>
            <p style="color: var(--text-muted); margin-bottom: 1.5rem;">
                Be the first to contribute a resource to this category!
            </p>
            {% if session.get('user_email') %}
                <a href="{{ url_for('business.submit_resource', category=category) }}" 
                   class="primary-button" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; text-decoration: none; border-radius: 4px; font-weight: 600;">
                    Submit Resource
                </a>
            {% else %}
                <p style="font-size: 0.9rem; color: var(--text-muted);">
                    <a href="{{ url_for('auth.login') }}" style="color: var(--primary-color);">Log in</a> to submit resources
                </p>
            {% endif %}
        </div>
    {% endif %}

    <!-- Learning Tracks from Config -->
    {% if category_info and category_info.tracks %}
        <div class="learning-tracks" style="margin-top: 3rem;">
            <h2 style="font-size: 1.5rem; margin-bottom: 1.5rem; text-align: center;">Learning Tracks</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
                {% for track in category_info.tracks %}
                    <div style="
                        padding: 1rem 1.25rem;
                        background: white;
                        border-radius: 6px;
                        border: 1px solid var(--border-color);
                        display: flex;
                        align-items: center;
                        gap: 0.75rem;
                    ">
                        <span style="color: var(--primary-color); font-size: 1.25rem;">‚úì</span>
                        <span style="font-size: 0.95rem;">{{ track }}</span>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}

    <!-- Featured Businesses -->
    {% if featured %}
        <div class="featured-businesses" style="margin-top: 4rem; padding-top: 3rem; border-top: 1px solid var(--border-color);">
            <h2 style="font-size: 1.5rem; margin-bottom: 1.5rem; text-align: center;">Trusted Businesses in This Space</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem;">
                {% for business in featured %}
                    <a href="{{ url_for('business.profile', slug=business.slug) }}" style="
                        padding: 1.25rem;
                        background: white;
                        border-radius: 8px;
                        border: 1px solid var(--border-color);
                        text-decoration: none;
                        color: inherit;
                        transition: transform 0.2s, box-shadow 0.2s;
                    " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                        
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            {% if business.logo_url %}
                                <img src="{{ business.logo_url }}" alt="{{ business.name }}" style="width: 40px; height: 40px; border-radius: 4px; object-fit: cover;">
                            {% else %}
                                <div style="width: 40px; height: 40px; border-radius: 4px; background: var(--bg-color); display: flex; align-items: center; justify-content: center; font-weight: 600; color: var(--primary-color);">
                                    {{ business.name[0] | upper }}
                                </div>
                            {% endif %}
                            <h3 style="font-size: 1rem; margin: 0;">{{ business.name }}</h3>
                        </div>
                        <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.5rem;">
                            {{ business.tagline[:80] }}{% if business.tagline|length > 80 %}...{% endif %}
                        </p>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span style="font-size: 0.75rem; padding: 0.2rem 0.5rem; background: #f0fdf4; color: #16a34a; border-radius: 3px; font-weight: 600;">
                                {{ business.trust_tier | default('trusted') | title }}
                            </span>
                        </div>
                    </a>
                {% endfor %}
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
